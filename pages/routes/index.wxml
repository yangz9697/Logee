<!--pages/routes/index.wxml-->
<view class="container">
  <block wx:if="{{routes.length > 0}}">
    <view class="card">
      <view class="station-section">
        <view class="station-group">
          <view class="station-label">始发站点</view>
          <view class="destination-grid">
            <view
              wx:for="{{routes}}"
              wx:key="startSite.id"
              class="grid-item {{selectedStartSite.startSite.id === item.startSite.id ? 'active' : ''}}"
              bindtap="onStartSiteChange"
              data-site="{{item}}"
            >
              <view>
                <text class="city-name">{{item.startSite.name}}</text>
              </view>
            </view>
          </view>
        </view>

        <view class="station-group">
          <view class="station-label">到达站点</view>
          <view class="destination-grid">
            <view
              wx:for="{{selectedStartSite.endSites}}"
              wx:key="site.id"
              class="grid-item {{selectedEndSite.site.id === item.site.id ? 'active' : ''}}"
              bindtap="onEndSiteChange"
              data-site="{{item}}"
            >
              <view>
                <text class="city-name">{{item.site.name}}</text>
              </view>
            </view>
          </view>
        </view>

        <view class="line-info" wx:if="{{selectedEndSite}}">
          <view class="info-item">
            <text class="label">运价：</text>
            <view class="value-edit">
              <input 
                class="price-input" 
                type="digit" 
                value="{{selectedEndSite.price}}"
                bindblur="onPriceChange"
              />
              <text>/吨</text>
            </view>
          </view>
          <view class="info-item">
            <text class="label">仓位：</text>
            <view class="value-edit">
              <input 
                class="capacity-input" 
                type="digit" 
                value="{{selectedEndSite.capacity}}"
                bindblur="onCapacityChange"
              />
              <text>吨</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <view class="footer-action">
      <view class="footer-btns">
        <view class="delete-btn" bindtap="onDeleteRoute" wx:if="{{selectedEndSite}}">
          <van-icon name="delete" color="#ee0a24" size="36rpx" />
          <text>删除线路</text>
        </view>
        <view class="{{selectedEndSite ? 'add-btn' : 'footer-btn'}}" bindtap="onAddRoute">
          新增线路
        </view>
      </view>
    </view>
  </block>

  <van-empty
    wx:else
    description="暂无线路"
  />
</view>
